<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout(~{::content}, '取引登録')}">
<body>
    <div th:fragment="content">
        <h2 class="mb-4"><i class="fas fa-plus"></i> 取引登録</h2>

        <div class="card">
            <div class="card-body">
                <form th:action="@{/transactions}" th:object="${transaction}" method="post">
                    <input type="hidden" th:field="*{transactionId}">

                    <!-- 取引タイプ -->
                    <div class="mb-3">
                        <label class="form-label">取引タイプ</label>
                        <div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio"
                                       th:field="*{transactionType}"
                                       value="EXPENSE" id="typeExpense">
                                <label class="form-check-label" for="typeExpense">
                                    <i class="fas fa-minus-circle text-danger"></i> 支出
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio"
                                       th:field="*{transactionType}"
                                       value="INCOME" id="typeIncome">
                                <label class="form-check-label" for="typeIncome">
                                    <i class="fas fa-plus-circle text-success"></i> 収入
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- カテゴリ -->
                    <div class="mb-3">
                        <label for="categoryId" class="form-label">カテゴリ</label>
                        <select class="form-select" th:field="*{categoryId}" id="categoryId"
                                th:errorclass="is-invalid">
                            <option value="">選択してください</option>
                            <option th:each="cat : ${categories}"
                                    th:value="${cat.categoryId}"
                                    th:text="${cat.categoryName}"></option>
                        </select>
                        <div class="invalid-feedback" th:if="${#fields.hasErrors('categoryId')}"
                             th:errors="*{categoryId}"></div>
                    </div>

                    <!-- 金額 -->
                    <div class="mb-3">
                        <label for="amount" class="form-label">金額</label>
                        <div class="input-group">
                            <span class="input-group-text">¥</span>
                            <input type="number" class="form-control"
                                   th:field="*{amount}" id="amount"
                                   step="1" min="0"
                                   th:errorclass="is-invalid">
                        </div>
                        <div class="invalid-feedback" th:if="${#fields.hasErrors('amount')}"
                             th:errors="*{amount}"></div>
                    </div>

                    <!-- 日付 -->
                    <div class="mb-3">
                        <label for="transactionDate" class="form-label">日付</label>
                        <input type="date" class="form-control"
                               th:field="*{transactionDate}" id="transactionDate"
                               th:errorclass="is-invalid">
                        <div class="invalid-feedback" th:if="${#fields.hasErrors('transactionDate')}"
                             th:errors="*{transactionDate}"></div>
                    </div>

                    <!-- メモ -->
                    <div class="mb-3">
                        <label for="description" class="form-label">メモ</label>
                        <textarea class="form-control"
                                  th:field="*{description}" id="description" rows="3"></textarea>
                    </div>

                    <!-- グループ -->
                    <div class="mb-3">
                        <label for="groupId" class="form-label">グループ（任意）</label>
                        <select class="form-select" th:field="*{groupId}" id="groupId">
                            <option value="">個人取引</option>
                            <option th:each="grp : ${groups}"
                                    th:value="${grp.groupId}"
                                    th:text="${grp.groupName}"></option>
                        </select>
                    </div>

                    <!-- ボタン -->
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> 保存
                        </button>
                        <a th:href="@{/transactions}" class="btn btn-secondary">
                            <i class="fas fa-times"></i> キャンセル
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
